% !TEX root = ../thesis.tex

% \begin{figure}[h!]
%   % \centering
%     \includegraphics[width=\textwidth,height=\textheight,keepaspectratio]{ae.png}
%   \caption{Autoencoder.}
%   \label{fig:ae}
% \end{figure}


\begin{figure}
  \tikzstyle{block} = [draw,minimum size=2em]
  \tikzstyle{data} = [draw,shape=circle,minimum size=2em]


  % diameter of semicircle used to indicate that two lines are not connected
  \def\radius{.7mm}
  \tikzstyle{branch}=[fill,shape=circle,minimum size=3pt,inner sep=0pt]

  \begin{tikzpicture}[>=latex']
  \node[data] at (0,0) (input) {C};
  \node[block] at (1.2,0) (l1) {$Linear$};
  \draw[->] (input) -- (l1);
  \node[block] at (2.8,0) (unpool2) {$Unpool_2$};
  \draw[->] (l1) -- (unpool2);
  \node[block] at (4.4,0) (dconv3) {$DConv_3$};
  \draw[->] (unpool2) -- (dconv3);
  \node[block] at (5.9,0) (relu3) {$ReLU$};
  \draw[->] (dconv3) -- (relu3);
  \node[block] at (7.4,0) (unpool1) {$Unpool_1$};
  \draw[->] (relu3) -- (unpool1);
  \node[block] at (9,0) (dconv2) {$DConv_2$};
  \draw[->] (unpool1) -- (dconv2);
  \node[block] at (10.5,0) (relu2) {$ReLU$};
  \draw[->] (dconv2) -- (relu2);
  \node[block] at (12,0) (dconv1) {$DConv_1$};
  \draw[->] (relu2) -- (dconv1);
  \node[block] at (13.5,0) (relu1) {$ReLU$};
  \draw[->] (dconv1) -- (relu1);
  \node[data] at (14.7,0) (output) {$\hat{\mathrm{I}}$};
  \draw[->] (relu1) -- (output);

  \end{tikzpicture}
\caption{Stacked autoencoder.}
\label{fig:sae}
\end{figure}
